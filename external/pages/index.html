<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="shortcut icon" href="assets/favicon.ico">

  <title>Elasticsearch Benchmarks</title>

  <!-- Bootstrap core CSS -->
  <link href="assets/css/Supernice.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="assets/css/navbar-fixed-top.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

  <script type="text/javascript">
var charts = {
  init: function(chartSpecs, url) {
    this.chartSpecs = chartSpecs;
    uiState = this.readUiStateFromUrl(url);
    this.restoreUiState(uiState);

    this.currentSpec = this.findSelectedSpec(uiState);
    this.dateRange = this.findDateRange();
    this.currentChartType = this.chartType();
    this.currentDistributionType = "default";

    this.buildMenu(this.currentSpec);
    this.buildOverview();
    this.installEventHandlers();

    this.render();
  },

  readUiStateFromUrl: function(url) {
    var route = url.split('/')[0];
    if (route === "#tracks") {
        return url.substring("#tracks/".length).split('/');
    } else {
        return [];
    }
  },

  restoreUiState: function(uiState) {
    if (uiState.length >= 2) {
        $("#checkToggleCompare").prop('checked', uiState[1] === "release");
    }
    if (uiState.length >= 4) {
        $("#dateRangeSelector").val(uiState[3]);
    }
  },

  buildMenu: function(activeItem) {
    var nav = $("#navigation-container");
    // remove any previous child elements.
    nav.empty();
    $.each(this.chartSpecs, function(index, value) {
        if (value === activeItem) {
            nav.append("<li class=\"active\"><a href=\"#\">" + value.track + "</a></li>");
        } else {
            var navItemId = "nav-item-" + value.id;
            nav.append("<li><a id=\"" + navItemId + "\" href=\"#\">" + value.track + "</a></li>");
            $("#" + navItemId).click(function(e) {
                e.preventDefault();
                charts.activateSpec(value);
            });
        }
    });
  },

  buildOverview: function(activeItem) {
    var nav = $("#tracks-overview-menu");
    // remove any previous child elements.
    nav.empty();
    $.each(this.chartSpecs, function(index, value) {
        var navItemId = "tracks-overview-nav-item-" + value.id;
        nav.append("<li><a id=\"" + navItemId + "\" href=\"#\">" + value.track + "</a>: " + value.description + ".</li>");
        $("#" + navItemId).click(function(e) {
            e.preventDefault();
            charts.activateSpec(value);
        });
    });
  },

  installEventHandlers: function() {
    $("#dateRangeSelector").change(function() {
        charts.dateRangeChanged();
    });
    $("#checkToggleCompare").click(function() {
        charts.chartTypeChanged();
    });
    $("#index-selector").click(function() {
        charts.selectMethodology();
    });
  },

  dateRangeChanged: function() {
    charts.dateRange = charts.findDateRange();
    charts.render();
  },

  chartTypeChanged: function() {
    charts.currentChartType = charts.chartType();
    charts.render();
  },

  selectMethodology: function() {
    charts.currentSpec = null;
    charts.buildMenu(charts.currentSpec);
    charts.render();
  },

  findSelectedSpec: function(uiState) {
    if (uiState.length > 0) {
        var trackName = uiState[0];
        return this.chartSpecs.find(function(t) {
            return t.id === trackName;
        });
    } else {
        return null;
    }
  },

  findDateRange: function() {
    return $("#dateRangeSelector option:selected").val();
  },

  chartType: function() {
    var e = $("#checkToggleCompare")[0];
    if (e.checked) {
        return "release";
    } else {
        return "nightly";
    }
  },

  activateSpec: function(spec) {
    this.currentSpec = spec;
    this.buildMenu(this.currentSpec);
    this.render();
  },

  showChart: function(url, dateRange) {
    $("#charts").html("<iframe id=\"charts\" src=\"" +url + "?embed=true&_g=(refreshInterval%3A(display%3AOff%2Cpause%3A!f%2Cvalue%3A0)%2Ctime%3A(from%3Anow-" + dateRange + "%2Cmode%3Aquick%2Cto%3Anow))\" height=\"100%\" width=\"100%\" frameBorder=\"0\"></iframe>");
  },

  dashboardUrl: function(chartId) {
    return "https://elasticsearch-benchmark-analytics.elastic.co/app/kibana#/dashboard/" + chartId;
  },

  render: function() {
    $('.methodology').hide();
    $('.tracks').hide();
    $("#dateRangeGroup").hide();
    $("#releaseLegend").hide();
    $("#warningLegend").hide();

    if (charts.currentSpec != null) {
        var hash = "#tracks/" + charts.currentSpec.id;

        $('.tracks').show();

        if ("warning" in charts.currentSpec) {
          $("#warningLegend").html(charts.currentSpec.warning).show();
        }

        if (charts.currentChartType === "nightly") {
          hash = hash + "/nightly/" + charts.currentDistributionType + "/" + charts.dateRange;
          var nightlyUrl = charts.dashboardUrl(charts.currentSpec.nightly_dashboards[charts.currentDistributionType]);
          $("#dateRangeGroup").show();
          $("#dashboard-url").attr("href", nightlyUrl);
          charts.showChart(nightlyUrl, charts.dateRange);
        } else {
          hash = hash + "/release";
          var releaseUrl = charts.dashboardUrl(charts.currentSpec.release_dashboard);
          $("#dashboard-url").attr("href", releaseUrl);
          $("#releaseLegend").show();
          //These charts should be time-independent. Don't use the date range here.
          charts.showChart(releaseUrl, "5y");
        }
        window.location.hash = hash;
    } else {
        $('.methodology').show();
        hash = "";
        window.location.hash = hash;
    }
  }
}
    </script>

  <style>
body,html,.main-display-area,.col-md-12 {
   height:100%;
}

.container {
  /* Bootsrap's default is 1170px */
  width: 1270px;
}
    </style>
</head>

<body>

<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a id="index-selector" class="navbar-brand" href="#">Elasticsearch Benchmarks</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul id="navigation-container" class="nav navbar-nav">
      </ul>
    </div><!--/.nav-collapse -->

  </div>
</div>

<div class="container tracks">
  <div class="row">
    <div class="col-md-8">
      <h3>Results</h3>
      <div class="alert alert-success alert-dismissible" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <strong>Hint</strong> These diagrams are just provided as an overview. Please go to the
        <a id="dashboard-url" href="#">Kibana dashboard</a> if you want to analyze the results in more detail.
      </div>
      <form class="form-horizontal">
        <div class="checkbox">
          <label><input type="checkbox" id="checkToggleCompare"> Show release charts</label>
        </div>
        <div class="form-group" id="dateRangeGroup">
          <div class="col-md-4">
            <label for="dateRangeSelector" class="control-label"> Date range for nightly</label>
            <select class="form-control" id="dateRangeSelector">
              <option value="30d" selected>Last 30 days</option>
              <option value="90d">Last 90 days</option>
              <option value="6M">Last 6 months</option>
              <option value="1y">Last year</option>
            </select>
          </div>
        </div>
      </form>
      <div id="releaseLegend">
        <h4>Legend</h4>
        <!--Remove the following line when release benchmarks on new env have been run-->
        <p>We test the following configurations:</p>
          <ul>
              <li><code>bare</code>: Elasticsearch on an unencrypted drive</li>
              <li><code>ear</code>: Elasticsearch on a drive that is encrypted with <a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/DMCrypt">dm-crypt</a> to benchmark the performance impact of encryption-at-rest.</li>
              <li><code>docker</code>: <a href="https://github.com/elastic/elasticsearch-docker">Official Elasticsearch Docker image</a></li>
              <li><code>oss</code>: Elasticsearch with <a href="https://github.com/elastic/elasticsearch#license">Apache 2.0 license</a></li>
              <li><code>basic</code>: Elasticsearch with <a href="https://www.elastic.co/subscriptions">commercial Elastic license</a>; see <a href="https://www.elastic.co/products/x-pack/open">x-pack/open</a>.</li>
              <li><code>trial-security</code>: Elasticsearch with <a href="https://www.elastic.co/products/x-pack/security">X-Pack Security and TLS</a> enabled.</li>
          </ul>
          <p>Starting with Elasticsearch 7.7.0, benchmarks are run with the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/setup.html#jvm-version">JDK that is bundled with Elasticsearch</a>.</p>
      </div>
      <div id="warningLegend" class="alert alert-warning" role="alert"></div>
    </div>
  </div>

  <div class="row" style="height:270em">
    <div class="col-md-12">
      <div id="charts" style="width:100%; height:100%"></div>
    </div>
  </div>
</div> <!-- /container -->

<!-- main content -->

<div class="container methodology">
  <div class="row">
    <div class="col-md-12">
      <h3>Overview</h3>
      <div class="panel panel-default">
        <div class="panel-body">
          <p>On this page are the results of the Elasticsearch nightly benchmarks based on the <a href="https://github.com/elastic/elasticsearch">master</a>
            branch as of that point in time. The Apache Software Foundation also provides a similar page for the <a
                    href="https://people.apache.org/~mikemccand/lucenebench/">Lucene nightly benchmarks</a>.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <h3>Benchmarks</h3>
      <ul id="tracks-overview-menu">
      </ul>
    </div>
  </div>


  <div class="row">
    <div class="col-md-12">
      <h3>Benchmarking Methodology</h3>
      <p>All benchmarks are run by <a href="https://github.com/elastic/rally">Rally</a> against the <a href="https://github.com/elastic/elasticsearch/tree/master/">Elasticsearch master branch</a> as of that date. The benchmark uses four bare-metal server-class machines. On one we run the benchmark driver (Rally), on the other three the benchmark candidate (one to three Elasticsearch nodes, one per machine). All machines are connected via a dedicated 10 GBit switched network.</p>

      <p>The benchmarks are intentionally not scalability benchmarks but rather show the performance characteristics of Elasticsearch ranging from one node to at most three nodes and are mainly intended to help the development team spot performance regressions.</p>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <h3>Benchmarking Environment</h3>
      <h4>Current environment</h4>
      <p>All benchmarks are run on bare-metal machines with the following specifications:</p>
      <ul>
        <li>CPU: <a href="https://ark.intel.com/products/97128/intel-core-i7-7700-processor-8m-cache-up-to-4-20-ghz.html">Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz</a></li>
        <li>RAM: 32 GB</li>
        <li>SSD: <a style="font-family:monospace;" href="https://www.micron.com/~/media/documents/products/data-sheet/ssd/1100_ssd.pdf">Micron_1100_MTFDDAK512TBN</a></li>
        <li>OS for Rally load driver servers:
          <ul>
            <li>Linux kernel version 5.4.0-65</li>
          </ul>
        </li>
        <li>OS for Elasticsearch target servers:
          <ul>
            <li>Linux kernel version 5.4.0-65</li>
            <li style="font-family:monospace;">/sys/kernel/mm/transparent_hugepage/enabled = always</li>
            <li style="font-family:monospace;">/sys/kernel/mm/transparent_hugepage/defrag = always</li>
            <li style="font-family:monospace;">/sys/devices/system/cpu/intel_pstate/no_turbo = 1</li>
          </ul>
        </li>
        <li>JVM: JDK bundled with Elasticsearch. </li>
      </ul>
      <p>All machines are connected via a dedicated 10 GBit switched network.</p>
      <h4>History of changes</h4>
      <ul>
        <li>2021-02-07:</li>
        <ul>
          <li>Upgraded all Rally load driver and Elasticsearch target servers to Ubuntu 18.04 Bionic, Linux Kernel 5.4.0-65</li>
        </ul>
        <li>2021-01-13:</li>
        <ul>
          <li>Replaced data disk on one target machine used by the tracks `geonames`, `geopoint`, `percolator`, `nyc_taxis` with another identical model (Micron_1100_MTFDDAK512TBN).</li>
        </ul>
        <li>2020-05-18:</li>
        <ul>
          <li>Replaced data disk on one target machine used by the tracks `geonames`, `geopoint`, `percolator`, `nyc_taxis` with another identical model (Micron_1100_MTFDDAK512TBN).</li>
        </ul>
        <li>2020-04-30:</li>
        <ul>
          <li>Run nightly benchmarks with JDK bundled with Elasticsearch.</li>
        </ul>
        <li>2020-04-06:</li>
        <ul>
          <li>Replaced data disk on all target machines used by the tracks `nested`, `noaa`, `pmc`, `http_logs` with another identical model (Micron_1100_MTFDDAK512TBN).</li>
        </ul>
        <li>2020-02-07:</li>
        <ul>
          <li>Performed OS package upgrade for load driver server used for tracks `nested`, `noaa`, `pmc`, `http_logs` and switched to kernel `4.15.0-76-generic`.</li>
        </ul>
        <li>2020-02-04:</li>
        <ul>
          <li>Performed OS package upgrade for load driver server used for tracks `geonames`, `geopoint`, `percolator`, `nyc_taxis` and switched to kernel `4.15.0-76-generic`.</li>
        </ul>
        <li>2019-12-12:</li>
        <ul>
          <li>Replaced data disk on first target machine used by the tracks `nested`, `noaa`, `pmc`, `http_logs` with another identical model (Micron_1100_MTFDDAK512TBN).</li>
        </ul>
        <li>2019-04-25:</li>
        <ul>
          <li>Switch to new benchmarking hardware and add benchmarks for default distribution</li>
        </ul>
        <li>2019-04-03:
          <ul>
            <li>Run nightly benchmarks with OpenJDK 11.0.2 instead of Oracle JDK 1.8.0_131-b11 (relates <a href="https://github.com/elastic/elasticsearch/pull/40754">elastic/elasticsearch#40754</a>)</li>
          </ul>
        </li>
        <li>2018-10-02:
          <ul>
            <li>Replaced data disk (Samsung MZ7LN512HMJP-00000) on first target machine with another model (Micron_M600_MTFDDAK512MBF) resulting in higher performance in some benchmarks.</li>
          </ul>
        </li>
        <li>2018-04-12:
          <ul>
            <li>Set <a href="https://www.kernel.org/doc/Documentation/vm/transhuge.txt">transparent_hugepage</a> <em style="font-family:monospace;">enabled</em> and <em style="font-family:monospace;">defrag</em> settings to <em style="font-family:monospace;">always</em>. This makes it consistent with the settings before the upgrade to 4.13.0.</li>
            <li>Upgrade kernel from version 4.13.0-36 to 4.13.0-38.</li>
          </ul>
        </li>
        <li>2018-02-21: Upgrade kernel from version 4.13.0-32 to 4.13.0-36.</li>
        <li>2018-02-06: Upgrade kernel from version 4.8.0-53 to 4.13.0-32.</li>
        <li>2017-10-06:
          <ul>
            <li>Change from one load generator and one target machine (connected via 1 GBit switch) to one load generator and three target machines (connected via 10 GBit switch).</li>
            <li>CPU has changed from <a href="http://ark.intel.com/products/88196/Intel-Core-i7-6700-Processor-8M-Cache-up-to-4_00-GHz">Intel(R) Core(TM) i7-6700 CPU @ 3.40GHz</a> to <a href="https://ark.intel.com/de/products/97128/Intel-Core-i7-7700-Processor-8M-Cache-up-to-4_20-GHz">Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz</a></li>
            <li>Disk has changed from <a href="http://www.crucial.com/usa/en/storage-ssd-mx200">Crucial MX200</a> to <a href="http://www.samsung.com/semiconductor/products/flash-storage/client-ssd/MZ7LN512HMJP?ia=831">Samsung MZ7LN512HMJP-00000</a></li>
          </ul>
        </li>
        <li>2017-06-29: Upgrade JDK from version 1.8.0_101-b13 to 1.8.0_131-b11</li>
        <li>2017-06-29: Upgrade kernel from version 4.4.0-72 to 4.8.0-53</li>
        <li>2017-04-13: Upgrade kernel from version 4.4.0-38 to 4.4.0-72</li>
      </ul>
    </div>
  </div>
</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script>
  $(document).ready(function() {
    charts.init([
        {
            "id": "geonames",
            "track": "Geonames",
            "description": "for evaluating the performance of structured data",
            "nightly_dashboards": {
                "default": "72825286-179d-4ec2-9322-6bb1bc7639cb",
            },
            "release_dashboard": "03995bef-a1a6-40e1-a438-ad718592974a"
        },
        {
            "id": "geopoint",
            "track": "Geopoint",
            "description": "for evaluating the performance of geo queries",
            "nightly_dashboards": {
              "default": "88b4bb7f-4e2a-4607-8f55-0d3e920a92f0",
            },
            "release_dashboard": "feecaa95-cbeb-4125-af0b-4d18405c1fa2"
        },
        {
            "id": "percolator",
            "track": "Percolator",
            "description": "for evaluating the performance of percolation queries",
            "nightly_dashboards": {
                "default": "7baeecea-229c-4284-a00e-00d85d234d28"
            },
            "release_dashboard": "302a91f0-d455-4be9-9a9d-c70ceed383fe"
        },
        {
            "id": "pmc",
            "track": "PMC",
            "description": "for evaluating the performance of full text search",
            "nightly_dashboards": {
                "default": "01db78da-402d-4462-9f6d-d319ade6da67"
            },
            "release_dashboard": "4c2a902c-3990-462a-a740-6dc1ed22bec9"
        },
        {
            "id": "nyc-taxis",
            "track": "NYC taxis",
            "description": "for evaluating the performance for highly structured data",
            "nightly_dashboards": {
                "default": "06c7cf83-c9f9-4466-8d9e-4b34b82841bb"
            },
            "release_dashboard": "0d991ea1-3eff-4fa1-828a-eac3920f4a5f"
        },
        {
            "id": "nested",
            "track": "Nested",
            "description": "for evaluating the performance for nested documents",
            "nightly_dashboards": {
              "default": "e76cda35-4e40-4bf1-97ca-c5b5c9c8384f"
            },
            "release_dashboard": "72ff21d9-f095-4f2c-bc88-49dbe04c04c2"
        },
        {
            "id": "http-logs",
            "track": "HTTP Logs",
            "description": "for evaluating the performance of (Web) server logs",
            "nightly_dashboards": {
                "default": "42fbadcc-159c-447d-b4f0-baf46b8a740f"
            },
            "release_dashboard": "e91fd04f-9261-4969-b486-d9badd82fbb1"
        },
        {
            "id": "noaa",
            "track": "noaa",
            "description": "for evaluating the performance of range fields",
            "nightly_dashboards": {
                "default": "3cd44b72-dd10-4e0b-ad76-e9a2b38cd144"
            },
            "release_dashboard": "0c9d1ee8-3df6-43c6-a04a-d00a71d885f8"
        },
        {
            "id": "eql",
            "track": "EQL",
            "description": "for evaluating the performance of EQL",
            "nightly_dashboards": {
                "default": "ee7bdacd-56d5-48ec-a765-f8b5183885b9"
            },
            "release_dashboard": "1607dd43-23b2-4d9b-9042-1c0fc0b44a2e"
        },
        {
            "id": "logging",
            "track": "Logging",
            "warning": "Observability benchmarks are under active development and shouldn't be consulted for any calculations at this point",
            "description": "for evaluating the performance of observability logging",
            "nightly_dashboards": {
                "default": "fd480790-f523-45ea-83ae-afce34fbf7f9"
            },
            "release_dashboard": "dc3eda76-7f1f-42b2-bb87-e2bcd1ab3602"
        }
    ], window.location.hash);
  });
</script>
</body>
</html>
