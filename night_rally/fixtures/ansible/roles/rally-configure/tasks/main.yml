---

- name: install production Rally config file
  become: true
  environment:
    # needs to be passed explicitly as we are becoming a different user
    RALLY_METRICS_STORE_CREDENTIAL_PATH: "{{ metrics_store_credential_path | default('')}}"
  template:
    src: rally.ini.j2
    dest: /var/lib/jenkins/.rally/rally-{{ rally_environment }}.ini
  when: not local_setup | default("false") | bool

- name: install local Rally config file
  template:
    src: rally.ini.j2
    dest: ${HOME}/.rally/rally-{{ rally_environment }}.ini
  when: local_setup | default("false") | bool
